# CampusWorld SSHæ§åˆ¶å°ç³»ç»Ÿ

## ğŸ¯ ç³»ç»Ÿæ¦‚è¿°

CampusWorld SSHæ§åˆ¶å°ç³»ç»Ÿæ˜¯ä¸€ä¸ªåŸºäºParamikoåº“å®ç°çš„ä¼ä¸šçº§SSHæœåŠ¡å™¨ï¼Œä¸ºCampusWorldé¡¹ç›®æä¾›å‘½ä»¤è¡Œäº¤äº’ç•Œé¢ã€‚ç³»ç»Ÿé›†æˆäº†ç°æœ‰çš„æƒé™ç®¡ç†ã€ç”¨æˆ·è®¤è¯å’Œå‘½ä»¤ç³»ç»Ÿï¼Œæ”¯æŒå¤šç”¨æˆ·å¹¶å‘è¿æ¥å’Œå®‰å…¨çš„å‘½ä»¤è¡Œæ“ä½œã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### 1. SSHæœåŠ¡å™¨åŠŸèƒ½
- **æ ‡å‡†SSHåè®®æ”¯æŒ**: åŸºäºParamikoå®ç°å®Œæ•´çš„SSHæœåŠ¡å™¨åŠŸèƒ½
- **å¤šç”¨æˆ·å¹¶å‘**: æ”¯æŒå¤šç”¨æˆ·åŒæ—¶è¿æ¥ï¼Œæ¯ä¸ªç”¨æˆ·ç‹¬ç«‹çš„ä¼šè¯ç®¡ç†
- **å®‰å…¨è®¤è¯**: é›†æˆç°æœ‰è´¦å·ç³»ç»Ÿï¼Œæ”¯æŒå¯†ç è®¤è¯
- **è¿æ¥ç®¡ç†**: è‡ªåŠ¨è¿æ¥æ¸…ç†ã€è¶…æ—¶ç®¡ç†ã€è¿æ¥é™åˆ¶

### 2. æ§åˆ¶å°äº¤äº’
- **å‘½ä»¤è¡Œç•Œé¢**: ç±»Unixçš„å‘½ä»¤è¡Œäº¤äº’ä½“éªŒ
- **å‘½ä»¤ç³»ç»Ÿ**: ä¸°å¯Œçš„å†…ç½®å‘½ä»¤ï¼Œæ”¯æŒå¸®åŠ©å’Œè‡ªåŠ¨è¡¥å…¨
- **ä¼šè¯ç®¡ç†**: å‘½ä»¤å†å²è®°å½•ã€ä¼šè¯çŠ¶æ€è·Ÿè¸ª
- **æƒé™æ§åˆ¶**: åŸºäºè§’è‰²çš„å‘½ä»¤è®¿é—®æ§åˆ¶

### 3. ä¼ä¸šçº§åŠŸèƒ½
- **ä¼šè¯ç›‘æ§**: å®æ—¶ç›‘æ§è¿æ¥çŠ¶æ€å’Œç”¨æˆ·æ´»åŠ¨
- **å®‰å…¨å®¡è®¡**: å‘½ä»¤æ‰§è¡Œæ—¥å¿—ã€è¿æ¥è®°å½•
- **æ€§èƒ½ä¼˜åŒ–**: é«˜æ•ˆçš„ä¼šè¯ç®¡ç†å’Œå‘½ä»¤å¤„ç†
- **é…ç½®ç®¡ç†**: çµæ´»çš„é…ç½®ç³»ç»Ÿå’Œçƒ­é‡è½½æ”¯æŒ

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ ¸å¿ƒæ¨¡å—

```
app/ssh/
â”œâ”€â”€ server.py          # SSHæœåŠ¡å™¨ä¸»æ¨¡å—
â”œâ”€â”€ session.py         # ä¼šè¯ç®¡ç†æ¨¡å—
â”œâ”€â”€ console.py         # æ§åˆ¶å°äº¤äº’æ¨¡å—
â”œâ”€â”€ commands.py        # å‘½ä»¤ç³»ç»Ÿæ¨¡å—
â””â”€â”€ config.py          # é…ç½®ç®¡ç†æ¨¡å—
```

### æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   SSH Client    â”‚    â”‚   SSH Client    â”‚    â”‚   SSH Client    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                      â”‚                      â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    CampusWorldSSHServer   â”‚
                    â”‚  (Paramiko Server)        â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚      SSHConsole           â”‚
                    â”‚   (Command Interface)     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   SSHCommandRegistry      â”‚
                    â”‚    (Command System)       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    SessionManager         â”‚
                    â”‚   (Session Management)    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
# å®‰è£…Paramiko
pip install paramiko

# å®‰è£…å…¶ä»–ä¾èµ–
pip install psutil
```

### 2. å¯åŠ¨SSHæœåŠ¡å™¨

```bash
# ä½¿ç”¨é»˜è®¤é…ç½®å¯åŠ¨
python start_ssh_server.py

# æŒ‡å®šç«¯å£å¯åŠ¨
python start_ssh_server.py --port 2223

# æ˜¾ç¤ºè¯¦ç»†é…ç½®ä¿¡æ¯
python start_ssh_server.py --verbose

# æ£€æŸ¥é…ç½®
python start_ssh_server.py --config-check
```

### 3. è¿æ¥SSHæœåŠ¡å™¨

```bash
# ä½¿ç”¨SSHå®¢æˆ·ç«¯è¿æ¥
ssh -p 2222 username@localhost

# ä½¿ç”¨é»˜è®¤è´¦å·æµ‹è¯•
ssh -p 2222 admin@localhost
# å¯†ç : admin123
```

## ğŸ“‹ å¯ç”¨å‘½ä»¤

### åŸºç¡€å‘½ä»¤

| å‘½ä»¤ | æè¿° | æƒé™è¦æ±‚ |
|------|------|----------|
| `help` | æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ | æ—  |
| `system` | æ˜¾ç¤ºç³»ç»Ÿä¿¡æ¯ | æ—  |
| `user` | æ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯ | æ—  |
| `exit` / `quit` | é€€å‡ºæ§åˆ¶å° | æ—  |
| `clear` | æ¸…å± | æ—  |
| `date` | æ˜¾ç¤ºå½“å‰æ—¶é—´ | æ—  |

### ç®¡ç†å‘½ä»¤

| å‘½ä»¤ | æè¿° | æƒé™è¦æ±‚ |
|------|------|----------|
| `sessions` | æ˜¾ç¤ºä¼šè¯ä¿¡æ¯ | system.view |
| `who` | æ˜¾ç¤ºåœ¨çº¿ç”¨æˆ· | æ—  |
| `history` | æ˜¾ç¤ºå‘½ä»¤å†å² | æ—  |
| `permission` | æ£€æŸ¥æƒé™ | æ—  |
| `status` | æ˜¾ç¤ºç³»ç»ŸçŠ¶æ€ | æ—  |
| `version` | æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ | æ—  |
| `config` | æ˜¾ç¤ºé…ç½®ä¿¡æ¯ | system.view |

### å‘½ä»¤ä½¿ç”¨ç¤ºä¾‹

```bash
# æŸ¥çœ‹å¸®åŠ©
help

# æŸ¥çœ‹ç‰¹å®šå‘½ä»¤å¸®åŠ©
help system

# æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯
system

# æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯
user

# æŸ¥çœ‹åœ¨çº¿ç”¨æˆ·
who

# æŸ¥çœ‹å‘½ä»¤å†å²
history 10

# æ£€æŸ¥æƒé™
permission user.create

# æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€
status

# æŸ¥çœ‹é…ç½®
config
```

## âš™ï¸ é…ç½®è¯´æ˜

### é…ç½®æ–‡ä»¶

SSHç³»ç»Ÿä½¿ç”¨YAMLé…ç½®æ–‡ä»¶ï¼Œæ”¯æŒç¯å¢ƒå˜é‡è¦†ç›–ï¼š

```yaml
ssh:
  # æœåŠ¡å™¨é…ç½®
  host: "0.0.0.0"
  port: 2222
  banner: "Welcome to CampusWorld SSH Console"
  
  # è®¤è¯é…ç½®
  auth_timeout: 60
  idle_timeout: 1800
  max_connections: 100
  max_connections_per_user: 3
  
  # å®‰å…¨é…ç½®
  allowed_auth_methods: ["password"]
  password_auth_enabled: true
  public_key_auth_enabled: false
  
  # å¯†é’¥é…ç½®
  host_key_path: "ssh_host_key"
  host_key_bits: 2048
  
  # æ—¥å¿—é…ç½®
  log_level: "INFO"
  log_file: "logs/ssh.log"
  
  # ä¼šè¯é…ç½®
  session_timeout: 1800
  max_command_history: 100
  enable_command_logging: true
```

### ç¯å¢ƒå˜é‡

```bash
# æœåŠ¡å™¨é…ç½®
SSH_HOST=0.0.0.0
SSH_PORT=2222

# è®¤è¯é…ç½®
SSH_AUTH_TIMEOUT=60
SSH_IDLE_TIMEOUT=1800

# å®‰å…¨é…ç½®
SSH_MAX_CONNECTIONS=100
SSH_MAX_CONNECTIONS_PER_USER=3
```

### é…ç½®éªŒè¯

```bash
# æ£€æŸ¥é…ç½®æœ‰æ•ˆæ€§
python start_ssh_server.py --config-check

# é‡æ–°åŠ è½½é…ç½®
python start_ssh_server.py --reload-config
```

## ğŸ” å®‰å…¨ç‰¹æ€§

### 1. è®¤è¯å®‰å…¨
- **å¯†ç è®¤è¯**: é›†æˆç°æœ‰è´¦å·ç³»ç»Ÿçš„å¯†ç éªŒè¯
- **è´¦å·çŠ¶æ€æ£€æŸ¥**: è‡ªåŠ¨æ£€æŸ¥è´¦å·é”å®šã€æš‚åœç­‰çŠ¶æ€
- **å¤±è´¥ç™»å½•ä¿æŠ¤**: è‡ªåŠ¨é”å®šå¤šæ¬¡å¤±è´¥ç™»å½•çš„è´¦å·
- **ä¼šè¯è¶…æ—¶**: è‡ªåŠ¨æ¸…ç†ç©ºé—²ä¼šè¯

### 2. è¿æ¥å®‰å…¨
- **è¿æ¥é™åˆ¶**: é™åˆ¶æ¯ä¸ªç”¨æˆ·çš„æœ€å¤§è¿æ¥æ•°
- **IPé™åˆ¶**: æ”¯æŒIPç™½åå•å’Œé»‘åå•
- **é€Ÿç‡é™åˆ¶**: é˜²æ­¢æš´åŠ›ç ´è§£æ”»å‡»
- **æ—¥å¿—è®°å½•**: å®Œæ•´çš„è¿æ¥å’Œæ“ä½œæ—¥å¿—

### 3. å‘½ä»¤å®‰å…¨
- **æƒé™æ§åˆ¶**: åŸºäºè§’è‰²çš„å‘½ä»¤è®¿é—®æ§åˆ¶
- **å‘½ä»¤å®¡è®¡**: è®°å½•æ‰€æœ‰å‘½ä»¤æ‰§è¡Œå†å²
- **å±é™©å‘½ä»¤è¿‡æ»¤**: è¿‡æ»¤å’Œæ‰§è¡Œå±é™©å‘½ä»¤
- **ä¼šè¯éš”ç¦»**: ç”¨æˆ·é—´ä¼šè¯å®Œå…¨éš”ç¦»

## ğŸ“Š ç›‘æ§å’Œç®¡ç†

### 1. ä¼šè¯ç›‘æ§

```bash
# æŸ¥çœ‹ä¼šè¯ç»Ÿè®¡
sessions

# æŸ¥çœ‹åœ¨çº¿ç”¨æˆ·
who

# æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€
status
```

### 2. æ—¥å¿—ç®¡ç†

```bash
# æŸ¥çœ‹SSHæ—¥å¿—
tail -f logs/ssh.log

# æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—
journalctl -u campusworld-ssh
```

### 3. æ€§èƒ½ç›‘æ§

ç³»ç»Ÿæä¾›å†…ç½®çš„æ€§èƒ½ç›‘æ§åŠŸèƒ½ï¼š
- è¿æ¥æ•°é‡ç»Ÿè®¡
- å‘½ä»¤æ‰§è¡Œç»Ÿè®¡
- ä¼šè¯æŒç»­æ—¶é—´ç»Ÿè®¡
- èµ„æºä½¿ç”¨æƒ…å†µ

## ğŸ§ª æµ‹è¯•å’Œè°ƒè¯•

### 1. è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œå®Œæ•´æµ‹è¯•
python test_ssh_system.py

# æµ‹è¯•ç‰¹å®šæ¨¡å—
python -c "from app.ssh.config import get_ssh_config; print(get_ssh_config().get_config_summary())"
```

### 2. è°ƒè¯•æ¨¡å¼

```bash
# å¯ç”¨è¯¦ç»†æ—¥å¿—
export SSH_LOG_LEVEL=DEBUG

# å¯åŠ¨æœåŠ¡å™¨
python start_ssh_server.py --verbose
```

### 3. è¿æ¥æµ‹è¯•

```bash
# æµ‹è¯•SSHè¿æ¥
ssh -p 2222 -o StrictHostKeyChecking=no admin@localhost

# æµ‹è¯•å‘½ä»¤æ‰§è¡Œ
echo "help" | ssh -p 2222 admin@localhost
```

## ğŸ”§ å¼€å‘å’Œæ‰©å±•

### 1. æ·»åŠ æ–°å‘½ä»¤

```python
from app.ssh.commands import SSHCommand

class MyCustomCommand(SSHCommand):
    def __init__(self):
        super().__init__("mycommand", "My custom command description")
    
    def execute(self, console, args):
        return "Command executed successfully!"

# æ³¨å†Œå‘½ä»¤
registry = SSHCommandRegistry()
registry.register_command(MyCustomCommand())
```

### 2. è‡ªå®šä¹‰è®¤è¯

```python
class CustomSSHServer(CampusWorldSSHServer):
    def check_auth_password(self, username, password):
        # è‡ªå®šä¹‰è®¤è¯é€»è¾‘
        if self.custom_auth_check(username, password):
            return AUTH_SUCCESSFUL
        return AUTH_FAILED
```

### 3. æ‰©å±•ä¼šè¯ç®¡ç†

```python
class CustomSSHSession(SSHSession):
    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        self.custom_data = {}
    
    def custom_method(self):
        # è‡ªå®šä¹‰æ–¹æ³•
        pass
```

## ğŸ“š APIå‚è€ƒ

### SSHCommandç±»

```python
class SSHCommand:
    def __init__(self, name, description, 
                 required_permission=None,
                 required_role=None,
                 required_access_level=None):
        pass
    
    def execute(self, console, args):
        """æ‰§è¡Œå‘½ä»¤"""
        pass
    
    def get_help(self):
        """è·å–å¸®åŠ©ä¿¡æ¯"""
        pass
    
    def get_usage(self):
        """è·å–ä½¿ç”¨è¯´æ˜"""
        pass
```

### SSHSessionç±»

```python
class SSHSession:
    def __init__(self, session_id, username, user_id, user_attrs):
        pass
    
    def update_activity(self):
        """æ›´æ–°æ´»åŠ¨æ—¶é—´"""
        pass
    
    def add_command(self, command):
        """æ·»åŠ å‘½ä»¤åˆ°å†å²"""
        pass
    
    def get_session_info(self):
        """è·å–ä¼šè¯ä¿¡æ¯"""
        pass
```

### SessionManagerç±»

```python
class SessionManager:
    def add_session(self, session):
        """æ·»åŠ ä¼šè¯"""
        pass
    
    def remove_session(self, session_id):
        """ç§»é™¤ä¼šè¯"""
        pass
    
    def get_session_stats(self):
        """è·å–ä¼šè¯ç»Ÿè®¡"""
        pass
    
    def cleanup_expired_sessions(self, timeout_minutes):
        """æ¸…ç†è¿‡æœŸä¼šè¯"""
        pass
```

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **è¿æ¥è¢«æ‹’ç»**
   - æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦å¯åŠ¨
   - æ£€æŸ¥ç«¯å£æ˜¯å¦æ­£ç¡®
   - æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

2. **è®¤è¯å¤±è´¥**
   - æ£€æŸ¥ç”¨æˆ·åå’Œå¯†ç 
   - æ£€æŸ¥è´¦å·çŠ¶æ€
   - æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—

3. **å‘½ä»¤æ‰§è¡Œé”™è¯¯**
   - æ£€æŸ¥ç”¨æˆ·æƒé™
   - æ£€æŸ¥å‘½ä»¤è¯­æ³•
   - æŸ¥çœ‹é”™è¯¯æ—¥å¿—

4. **æ€§èƒ½é—®é¢˜**
   - æ£€æŸ¥è¿æ¥æ•°é‡
   - æ£€æŸ¥ç³»ç»Ÿèµ„æº
   - ä¼˜åŒ–é…ç½®å‚æ•°

### æ—¥å¿—åˆ†æ

```bash
# æŸ¥çœ‹è®¤è¯æ—¥å¿—
grep "Authentication" logs/ssh.log

# æŸ¥çœ‹è¿æ¥æ—¥å¿—
grep "Connection" logs/ssh.log

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
grep "ERROR" logs/ssh.log
```

## ğŸ”® æœªæ¥è§„åˆ’

### çŸ­æœŸç›®æ ‡
- **å…¬é’¥è®¤è¯**: æ”¯æŒSSHå¯†é’¥è®¤è¯
- **SFTPæ”¯æŒ**: æ·»åŠ æ–‡ä»¶ä¼ è¾“åŠŸèƒ½
- **å‘½ä»¤è¡¥å…¨**: å®ç°Tabé”®è‡ªåŠ¨è¡¥å…¨
- **ä¼šè¯æŒä¹…åŒ–**: æ”¯æŒä¼šè¯æ¢å¤

### ä¸­æœŸç›®æ ‡
- **Webç®¡ç†ç•Œé¢**: æä¾›Webç®¡ç†ç•Œé¢
- **é›†ç¾¤æ”¯æŒ**: æ”¯æŒå¤šæœåŠ¡å™¨é›†ç¾¤
- **æ’ä»¶ç³»ç»Ÿ**: æ”¯æŒå‘½ä»¤æ’ä»¶æ‰©å±•
- **APIæ¥å£**: æä¾›REST APIæ¥å£

### é•¿æœŸç›®æ ‡
- **å®¹å™¨åŒ–éƒ¨ç½²**: æ”¯æŒDockerå’ŒKubernetes
- **äº‘åŸç”Ÿ**: æ”¯æŒäº‘å¹³å°éƒ¨ç½²
- **AIé›†æˆ**: æ™ºèƒ½å‘½ä»¤æ¨èå’Œå¸®åŠ©
- **å›½é™…åŒ–**: å¤šè¯­è¨€æ”¯æŒ

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

---

**CampusWorld SSHæ§åˆ¶å°ç³»ç»Ÿ** - ä¼ä¸šçº§SSHæœåŠ¡å™¨è§£å†³æ–¹æ¡ˆ ğŸš€
